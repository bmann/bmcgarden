---
title: Notes on running your own Mastodon instance on Heroku
date: '2017-04-15T15:34:34-07:00'
tags:
  - Heroku
  - Mastodon
---

<p name="5ed2" id="5ed2" class="graf graf--p graf--leading"><a href="https://medium.com/u/f841dc3192de" data-href="https://medium.com/u/f841dc3192de" data-anchor-type="2" data-user-id="f841dc3192de" data-action-value="f841dc3192de" data-action="show-user-card" data-action-type="hover" class="markup--user markup--p-user" target="_blank">Darren Barefoot</a> kicked off a <a href="https://www.facebook.com/dbarefoot/posts/10155060142235600" data-href="https://www.facebook.com/dbarefoot/posts/10155060142235600" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">discussion on Facebook</a> asking if people wanted to run Mastodon locally:</p>
<blockquote name="1f3c" id="1f3c" class="graf graf--blockquote graf-after--p">Who wants to help me set up a Mastodon instance for Vancouver-related stuff? I’ll provide the moral support, promotion and pay for hosting if someone wants to do the hard technical bits.</blockquote>
<blockquote name="8dfa" id="8dfa" class="graf graf--blockquote graf-after--blockquote">Or maybe that’s the wrong vector. Maybe we should set up an NGO tech and digital instance. Or maybe both?</blockquote>
<p name="5390" id="5390" class="graf graf--p graf-after--blockquote">I responded that maybe everyone should run their own instance:</p>
<figure name="6773" id="6773" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 479px; max-height: 376px;">
<div class="aspectRatioPlaceholder-fill" style="padding-bottom: 78.5%;"></div>
<img class="graf-image" data-image-id="1*IWD5lyPAqw8NibZPfvHDNA.png" data-width="479" data-height="376" src="https://microblog.bmannconsulting.com/uploads/2020/c339a4e9e1.jpg">
</div></figure><p name="60ca" id="60ca" class="graf graf--p graf-after--figure">Does it make sense for a community or group to run their own install? As much as I love open source, running an entire software stack securely — and not losing everyone’s data because you don’t have good backups — is a big job. I tend to discourage people from running their own software, instead mapping a domain name to Medium or Tumblr.</p>
<blockquote name="a11d" id="a11d" class="graf graf--pullquote graf-after--p">From my point of view, anything with an API that I can map my own domain to meets the bar of a resilient service — me, <a href="https://medium.bmannconsulting.com/self-hosting-doesnt-help-more-people-self-publish-b6bde64d2bcb" data-href="https://medium.bmannconsulting.com/self-hosting-doesnt-help-more-people-self-publish-b6bde64d2bcb" class="markup--anchor markup--pullquote-anchor" rel="noopener" target="_blank">Self-hosting doesn’t help more people self-publish</a>
</blockquote>
<p name="105b" id="105b" class="graf graf--p graf-after--pullquote">Kind of contrary to that, I wrote a response to <a href="https://hackernoon.com/mastodon-is-dead-in-the-water-888c10e8abb1" data-href="https://hackernoon.com/mastodon-is-dead-in-the-water-888c10e8abb1" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Mastodon is Dead in the Water</a> saying that people should <a href="https://medium.com/@bmann/run-your-own-mastadon-instance-265897cc336d" data-href="https://medium.com/@bmann/run-your-own-mastadon-instance-265897cc336d" class="markup--anchor markup--p-anchor" target="_blank">run their own Mastodon instance</a>.</p>
<p name="f73c" id="f73c" class="graf graf--p graf-after--p">I was still in Toronto at the time, and actually got Mastodon setup using just the browser on my phone with the <a href="https://github.com/tootsuite/documentation/blob/master/Running-Mastodon/Heroku-guide.md" data-href="https://github.com/tootsuite/documentation/blob/master/Running-Mastodon/Heroku-guide.md" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Deploy to Heroku button</a>. This is a feature of Heroku I love, and I’ve created several of these buttons of my own to help people get apps up and running.</p>
<p name="cb5b" id="cb5b" class="graf graf--p graf-after--p">This Easter weekend (it took me a solid half a day yesterday) I finally did the work to fully setup a Mastodon instance. I set one up for <a href="https://www.frontierfoundry.co" data-href="https://www.frontierfoundry.co" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Frontier Foundry</a>, my new venture. I thought we might use it for links and tweet-length commentary for us and our portfolio companies. Or it might just be something to experiment with for a couple of weeks.</p>
<figure name="5e32" id="5e32" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 340px;">
<div class="aspectRatioPlaceholder-fill" style="padding-bottom: 48.6%;"></div>
<a href="https://mastodon.frontierfoundry.co/@boris" data-href="https://mastodon.frontierfoundry.co/@boris" class="graf-imageAnchor" data-action="image-link" data-action-observe-only="true" rel="noopener" target="_blank"><img class="graf-image" data-image-id="1*ubT9B0hPZ9Eu9uVODwVm5Q.png" data-width="700" data-height="340" src="https://microblog.bmannconsulting.com/uploads/2020/8831df6ccf.jpg"></a>
</div></figure><p name="b411" id="b411" class="graf graf--p graf-after--figure">My profile on the Frontier Foundry mastodon instance lives at <a href="https://mastodon.frontierfoundry.co/@boris" data-href="https://mastodon.frontierfoundry.co/@boris" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">mastodon.frontierfoundry.co/@boris</a>. There’s even an <a href="http://mastodon.frontierfoundry.co/users/boris.atom" data-href="http://mastodon.frontierfoundry.co/users/boris.atom" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">RSS feed for each user</a> which enables interesting re-use — I’ve setup an IFTTT recipe that posts anything from that feed to my Twitter account if it contains the keyword “share”.</p>
<h4 name="1409" id="1409" class="graf graf--h4 graf-after--p">Setting up Mastodon on Heroku</h4>
<p name="ffbf" id="ffbf" class="graf graf--p graf-after--h4">Here are the things you’re going to need to have accounts on / be comfortable working with:</p>
<ul class="postList">
<li name="8782" id="8782" class="graf graf--li graf-after--p">a domain name and a registrar where you can edit DNS settings. I tend to use <a href="http://namecheap.com" data-href="http://namecheap.com" class="markup--anchor markup--li-anchor" rel="noopener" target="_blank">Namecheap</a>, while <a href="https://www.hover.com/" data-href="https://www.hover.com/" class="markup--anchor markup--li-anchor" rel="noopener" target="_blank">Hover</a> is my “regular user” recommendation that also happens to be Canadian. Domains tend to be about $10USD per year, although there are also much cheaper ones and specials.</li>
<li name="c8b1" id="c8b1" class="graf graf--li graf-after--li">an <a href="https://aws.amazon.com/" data-href="https://aws.amazon.com/" class="markup--anchor markup--li-anchor" rel="noopener" target="_blank">Amazon AWS account</a>: accounts are free although you will have to have a credit card attached. The S3 file storage here will cost perhaps $1USD per month at most.</li>
<li name="66ff" id="66ff" class="graf graf--li graf-after--li">a <a href="http://heroku.com" data-href="http://heroku.com" class="markup--anchor markup--li-anchor" rel="noopener" target="_blank">Heroku</a> account: accounts are free, you’ll need a credit card attached to your account, and I am currently paying what will amount to $14USD per month for hosting</li>
</ul>
<p name="9e97" id="9e97" class="graf graf--p graf-after--li">Next, you may very well need to have a desktop computer setup with Ruby, Node, git, and a full suite of developer tools to be successful in getting everything working.</p>
<p name="51e6" id="51e6" class="graf graf--p graf-after--p">Reading <a href="https://ashfurrow.com/blog/running-mastodon-on-heroku/" data-href="https://ashfurrow.com/blog/running-mastodon-on-heroku/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Ash Furrow’s Running Mastodon on Heroku</a> meant that someone had hit many roadblocks ahead of me and figured out some of the workarounds, which was great. The setup I ended up following was two Heroku installs to get the Streaming API working, as per the <a href="https://github.com/tootsuite/mastodon/issues/1119#issuecomment-292816340" data-href="https://github.com/tootsuite/mastodon/issues/1119#issuecomment-292816340" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">comment in this issue by ecmendenhall</a> (thanks <a href="https://medium.com/u/63ecced19e3d" data-href="https://medium.com/u/63ecced19e3d" data-anchor-type="2" data-user-id="63ecced19e3d" data-action-value="63ecced19e3d" data-action="show-user-card" data-action-type="hover" class="markup--user markup--p-user" target="_blank">Connor Mendenhall</a>!).</p>
<p name="844c" id="844c" class="graf graf--p graf-after--p">I wasted a lot of time setting things up from scratch with a fresh clone of mastodon, when starting with the Deploy to Heroku and just adding the second streaming server would have probably been a better decision.</p>
<p name="1d82" id="1d82" class="graf graf--p graf-after--p">The other thing that took a lot of time was setting up the Heroku Mailgun add-on. After you add it, you need to verify yourself, and then take a whole bunch of other steps in both Mailgun and your DNS / MX settings for it to be fully working. Do this right at the beginning.</p>
<p name="6ce9" id="6ce9" class="graf graf--p graf-after--p">I’ve still got one piece of troubleshooting / bug to figure out with Amazon S3 settings where S3_BUCKET and S3_HOSTNAME duplicate each other (and even there I’m not going to bother doing SSL with Cloudfront, which means there is a mix of secure content and insecure images).</p>
<h4 name="10f5" id="10f5" class="graf graf--h4 graf-after--p">Should people run their own software?</h4>
<p name="69c3" id="69c3" class="graf graf--p graf-after--h4">In short, the answer is no. The level of expertise — and I’m not even talking digital literacy, I’m talking learned, professional expertise — that someone requires to run, maintains, and secure software is very high.</p>
<p name="2b6c" id="2b6c" class="graf graf--p graf-after--p">That’s one of the reasons I run as many things as I can on Heroku. I don’t have to worry about the lower levels of an operating system at all.</p>
<p name="76fe" id="76fe" class="graf graf--p graf-after--p">Docker is the other newest kid on the block, and Mastodon is setup to work well with Docker. But Docker and various places where you can host docker containers don’t solve the fact that you are still exposed to the entire operating system stack of a server, which is where many security and backup issues lie.</p>
<p name="c730" id="c730" class="graf graf--p graf-after--p">With Heroku, database backups are included, it’s just a snapshot of code and configuration, and Amazon S3 backs up the files automatically, too. Heroku even handles SSL certificates automatically for paid accounts.</p>
<p name="cecd" id="cecd" class="graf graf--p graf-after--p">The folks building mastodon are helpful to a point in getting things running on Heroku, but ultimately are focused on maintaining a more traditional software stack that they use for their own development and deployment. I think that going forward, applications need to be designed to be deployed in simpler fashion, with less of a “stack” and more pluggable components.</p>
<p name="bd0b" id="bd0b" class="graf graf--p graf-after--p">What would a mastodon that was designed to be run “serverless” look like?</p>
<h4 name="f93f" id="f93f" class="graf graf--h4 graf-after--p">Decentralized and P2P apps of the future</h4>
<p name="2e34" id="2e34" class="graf graf--p graf-after--h4">I’ve been working a lot with blockchain and other decentralized / P2P applications lately. I wrote about the <a href="https://medium.bmannconsulting.com/akasha-planting-tag-flag-vancouver-bowen-island-canada-49907fa370c" data-href="https://medium.bmannconsulting.com/akasha-planting-tag-flag-vancouver-bowen-island-canada-49907fa370c" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Akasha decentralized blogging platform</a> that runs on the Ethereum blockchain, and I’ve also poked about with <a href="https://beakerbrowser.com/" data-href="https://beakerbrowser.com/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Beaker Browser</a>, which runs on the <a href="https://datproject.org/" data-href="https://datproject.org/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">dat protocol</a> underneath.</p>
<p name="ab94" id="ab94" class="graf graf--p graf-after--p">It was a lot of work to setup an instance of mastodon on Heroku. For someone that has tinkered with open source tech and servers for 15+ years and has a computer science degree.</p>
<p name="2be1" id="2be1" class="graf graf--p graf-after--p">And with that, I’m still paying a relatively high amount (I don’t think I could justify $15/month or $180 years for just my personal usage), never mind “renting” a domain name from the DNS system. mastodon works in a mobile web browser or with some iOS or Android apps, but I don’t think I could have completed the entire setup and install from my phone.</p>
<p name="43c3" id="43c3" class="graf graf--p graf-after--p">As I <a href="https://medium.bmannconsulting.com/self-hosting-doesnt-help-more-people-self-publish-b6bde64d2bcb" data-href="https://medium.bmannconsulting.com/self-hosting-doesnt-help-more-people-self-publish-b6bde64d2bcb" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">wrote before</a>, I think the list of things we need to aim for with these future decentralized apps is:</p>
<ol class="postList">
<li name="511b" id="511b" class="graf graf--li graf-after--p">
<strong class="markup--strong markup--li-strong">Publish from a smartphone:</strong> the smartphone will be the only computing device for most of the world going forward. Focus on it.</li>
<li name="c084" id="c084" class="graf graf--li graf-after--li">
<strong class="markup--strong markup--li-strong">No server hosting:</strong> fully decentralized / peer-to-peer. There may still be various semi- or fully-centralized services for discovery, naming, trust, or other convenience functions.</li>
<li name="c161" id="c161" class="graf graf--li graf-after--li">
<strong class="markup--strong markup--li-strong">No domain names:</strong> let’s not rent our identifiers, and let’s not build financial barriers to anyone “owning” their content online</li>
</ol>
<p name="259a" id="259a" class="graf graf--p graf-after--li graf--trailing">I’m going to continue exploring in this space. In the meantime, it’s great to see mastodon bringing a bunch of discussion forward, and for us all to think about federation, decentralization, and what that means for designing interactions.</p>